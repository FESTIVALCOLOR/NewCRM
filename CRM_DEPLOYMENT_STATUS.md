# üöÄ –ì–æ—Ç–æ–≤–æ –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é: CRM –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

## ‚úÖ –ß—Ç–æ —É–∂–µ —Å–¥–µ–ª–∞–Ω–æ (–Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ)

1. **API –º–µ—Ç–æ–¥—ã** - –î–æ–±–∞–≤–ª–µ–Ω—ã 6 –º–µ—Ç–æ–¥–æ–≤ –≤ `utils/api_client.py`
2. **UI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** - –û–±–Ω–æ–≤–ª–µ–Ω `ui/crm_tab.py` (17 —Ç–æ—á–µ–∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏)
3. **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - –†–∞–±–æ—Ç–∞–µ—Ç —Å API –∏ –±–µ–∑ –Ω–µ–≥–æ
4. **–ó–∞–∫–æ–º–º–∏—á–µ–Ω–æ** - –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ Git

## ‚è≥ –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å (–Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ)

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# 1. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä
scp deploy_crm.sh root@147.45.154.193:/opt/interior_studio/

# 2. –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh root@147.45.154.193

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç
cd /opt/interior_studio
bash deploy_crm.sh
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –†—É—á–Ω–æ–π (–ø–æ—à–∞–≥–æ–≤—ã–π)

–°–ª–µ–¥–æ–≤–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –≤ —Ñ–∞–π–ª–µ: **MANUAL_DEPLOYMENT_STEPS.txt**

–û—Å–Ω–æ–≤–Ω—ã–µ —à–∞–≥–∏:
1. –°–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏
2. –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã –≤ PostgreSQL (–≤—ã–ø–æ–ª–Ω–∏—Ç—å `server_crm_migration.sql`)
3. –î–æ–±–∞–≤–∏—Ç—å –º–æ–¥–µ–ª–∏ –≤ `server/database.py` (–∏–∑ `server_crm_models.py`)
4. –î–æ–±–∞–≤–∏—Ç—å —Å—Ö–µ–º—ã –≤ `server/schemas.py` (–∏–∑ `server_crm_schemas.py`)
5. –î–æ–±–∞–≤–∏—Ç—å —Ä–æ—É—Ç—ã –≤ `server/main.py` (–∏–∑ `server_crm_routes.py`)
6. –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å Docker: `docker-compose build api && docker-compose up -d`

## üìã –§–∞–π–ª—ã –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

–í—Å–µ —Ñ–∞–π–ª—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ `d:\New CRM\interior_studio\`:

| –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------|-----------|
| `server_crm_migration.sql` | SQL —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü |
| `server_crm_models.py` | –ú–æ–¥–µ–ª–∏ SQLAlchemy |
| `server_crm_schemas.py` | Pydantic —Å—Ö–µ–º—ã |
| `server_crm_routes.py` | API —Ä–æ—É—Ç—ã |
| `deploy_crm.sh` | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è |
| `MANUAL_DEPLOYMENT_STEPS.txt` | –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è |
| `CRM_DEPLOYMENT_INSTRUCTIONS.md` | –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è |

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ Python –∫–ª–∏–µ–Ω—Ç (–ª–æ–∫–∞–ª—å–Ω–æ)

```bash
cd "d:\New CRM\interior_studio"

.venv\Scripts\python.exe -c "
from utils.api_client import APIClient
client = APIClient('https://147.45.154.193')
result = client.login('admin', 'admin123')
print('[OK] Login successful')

# –¢–µ—Å—Ç CRM API
cards = client.get_crm_cards('–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π')
print(f'[OK] CRM API working! Got {len(cards)} cards')
"
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ curl (–Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ)

```bash
TOKEN=$(curl -k -X POST https://localhost/api/auth/login \
  -d "username=admin&password=admin123" \
  | jq -r '.access_token')

curl -k -H "Authorization: Bearer $TOKEN" \
  "https://localhost/api/crm/cards?project_type=–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π"
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

–ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –æ—Ç–∫—Ä—ã—Ç—å –≤–∫–ª–∞–¥–∫—É CRM:
- –î–æ–ª–∂–Ω—ã –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è –∫–∞—Ä—Ç–æ—á–∫–∏ –∏–∑ API
- –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫ –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å
- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å

## ‚ö†Ô∏è –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞: –¢–∞–±–ª–∏—Ü—ã —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç
```
ERROR:  relation "crm_cards" already exists
```
**–†–µ—à–µ–Ω–∏–µ:** –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, —Ç–∞–±–ª–∏—Ü—ã –±—ã–ª–∏ —Å–æ–∑–¥–∞–Ω—ã. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –¥–∞–ª—å—à–µ.

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ CRMCard
```
NameError: name 'CRMCard' is not defined
```
**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –º–æ–¥–µ–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ `server/database.py`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã –≤ `server/main.py`

### –ü—Ä–æ–±–ª–µ–º–∞: HTTP 500 –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ
**–†–µ—à–µ–Ω–∏–µ:** –°–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏:
```bash
docker-compose logs -f api
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ü—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç []
**–†–µ—à–µ–Ω–∏–µ:** –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –µ—Å–ª–∏ –≤ –ë–î –Ω–µ—Ç CRM –∫–∞—Ä—Ç–æ—á–µ–∫. API —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

## üìä –°—Ç–∞—Ç—É—Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –º–æ–¥—É–ª–µ–π

| –ú–æ–¥—É–ª—å | –ö–ª–∏–µ–Ω—Ç | –°–µ—Ä–≤–µ—Ä | –°—Ç–∞—Ç—É—Å |
|--------|--------|--------|--------|
| Dashboard | ‚úÖ | ‚úÖ | –ì–æ—Ç–æ–≤–æ |
| Clients | ‚úÖ | ‚úÖ | –ì–æ—Ç–æ–≤–æ |
| Employees | ‚úÖ | ‚úÖ | –ì–æ—Ç–æ–≤–æ |
| Contracts | ‚úÖ | ‚úÖ | –ì–æ—Ç–æ–≤–æ |
| **CRM** | ‚úÖ | ‚è≥ | **–¢—Ä–µ–±—É–µ—Ç—Å—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ** |
| CRM Supervision | ‚ùå | ‚ùå | –û–∂–∏–¥–∞–µ—Ç |
| Reports | ‚ùå | ‚ùå | –û–∂–∏–¥–∞–µ—Ç |
| Salaries | ‚ùå | ‚ùå | –û–∂–∏–¥–∞–µ—Ç |

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è CRM:

1. **CRM Supervision** - –ê–≤—Ç–æ—Ä—Å–∫–∏–π –Ω–∞–¥–∑–æ—Ä (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ CRM)
2. **Reports** - –û—Ç—á–µ—Ç—ã –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
3. **Salaries** - –ó–∞—Ä–ø–ª–∞—Ç—ã –∏ –≤—ã–ø–ª–∞—Ç—ã
4. **–ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** - –ü–µ—Ä–µ–Ω–æ—Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö CRM –∫–∞—Ä—Ç–æ—á–µ–∫ –∏–∑ SQLite –≤ PostgreSQL

---

**–ê–≤—Ç–æ—Ä:** Claude Code
**–î–∞—Ç–∞:** 25.12.2025
**–ö–æ–º–º–∏—Ç:** b2b92ef - Add CRM API integration (client-side)
